package org.openmrs.module.eptsreports.reporting.library.queries;

public interface TxTPTCompletationQueries {

  class QUERY {

    public static final String findPatientsWhoStartedINHTherapyBeforeReportingEndDate =
        "																"
            + "select distinct inicio_inh.patient_id from																								"
            + " ( 																																		"
            + " 	select p.patient_id, o.value_datetime data_inicio_inh 																				"
            + " 		from patient p 																													"
            + " 			inner join encounter e on p.patient_id=e.patient_id 																		"
            + " 			inner join obs o on o.encounter_id=e.encounter_id 																			"
            + " 		where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128  						"
            + " 			and o.value_datetime < :endDate and e.location_id=:location 																"
            + "    union																																"
            + " 	select p.patient_id, e.encounter_datetime data_inicio_inh 																			"
            + " 		from	patient p 																												"
            + " 			inner join encounter e on p.patient_id=e.patient_id 																		"
            + " 			inner join obs o on o.encounter_id=e.encounter_id 																			"
            + " 		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256 		"
            + " 			and e.encounter_datetime < :endDate and e.location_id=:location 															"
            + " 	union 																																"
            + " 	select p.patient_id, e.encounter_datetime data_inicio_inh from patient p															"
            + " 		inner join encounter e on p.patient_id=e.patient_id																				"
            + "    	inner join obs o on o.encounter_id=e.encounter_id																					"
            + "    where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 		"
            + "    	and e.encounter_datetime < :endDate and e.location_id=:location	 																	"
            + ") inicio_inh 																															";

    public static final String findPatientsWhoCompletedINHTherapy =
        "                                                                            					"
            + "	select inicio_inh.patient_id from 																													"
            + "					( 																																	"
            + "						select p.patient_id, o.value_datetime data_inicio_inh 																			"
            + "							from	patient p 																									    	"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 					"
            + "								and o.value_datetime < :endDate and e.location_id=:location 															"
            + "						union 																															"
            + "						select p.patient_id, e.encounter_datetime data_inicio_inh 																		"
            + "							from patient p 																												"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "								and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "						union 																															"
            + "             				select p.patient_id, e.encounter_datetime data_inicio_inh from patient p												"
            + "             					inner join encounter e on p.patient_id=e.patient_id																	"
            + "                				inner join obs o on o.encounter_id=e.encounter_id																		"
            + "                			where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                				and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "					) inicio_inh 																														"
            + "					inner join 																															"
            + "					(	select patient_id, data_final_inh 																								"
            + "						from( 																															"
            + "							select p.patient_id, o.value_datetime data_final_inh 																		"
            + "							from patient p 																												"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6129 						"
            + "								and o.value_datetime <= :endDate and e.location_id=:location 															"
            + "							union																														"
            + "							select p.patient_id, e.encounter_datetime data_final_inh 																	"
            + "							from patient p 																												"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "							where 	p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type=6 and o.concept_id=6122 and o.value_coded=1267 		"
            + "									and e.encounter_datetime<= :endDate and e.location_id=:location 													"
            + "						) endINH 																														"
            + "					) termino_inh on inicio_inh.patient_id=termino_inh.patient_id 																		"
            + "					where termino_inh.data_final_inh between  inicio_inh.data_inicio_inh + interval 173 day and inicio_inh.data_inicio_inh + interval 365 day													"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select p.patient_id, o.value_datetime data_inicio_inh 																			"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 					"
            + "								and o.value_datetime < :endDate and e.location_id=:location 															"
            + "						union 																															"
            + "						select p.patient_id, e.encounter_datetime data_inicio_inh 																		"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "								and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "							union 																														"
            + "             					select p.patient_id, e.encounter_datetime data_inicio_inh from patient p											"
            + "             						inner join encounter e on p.patient_id=e.patient_id																"
            + "                					inner join obs o on o.encounter_id=e.encounter_id																	"
            + "                				where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                					and e.encounter_datetime < :endDate and e.location_id=:location  													"
            + "					) inicio_inh 																														"
            + "					inner join encounter e on e.patient_id=inicio_inh.patient_id 																		"
            + "					inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																	"
            + "					left join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id and obsDTINH.voided=0 												"
            + "							and obsDTINH.concept_id=1719 and obsDTINH.value_coded=23955 																"
            + "							and obsDTINH.obs_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) 			"
            + "					where e.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (6,9) and obsLevTPI.concept_id=6122 and obsLevTPI.value_coded in (1257,1065,1256) "
            + "						and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) 				"
            + "						and obsDTINH.concept_id is null and e.location_id=:location 																	"
            + "						group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=6 													"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select p.patient_id, o.value_datetime data_inicio_inh 																			"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 					"
            + "								and o.value_datetime < :endDate and e.location_id=:location 															"
            + "						union 																															"
            + "						select p.patient_id, e.encounter_datetime data_inicio_inh 																		"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "								and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "						union 																															"
            + "             				select p.patient_id, e.encounter_datetime data_inicio_inh from patient p												"
            + "             					inner join encounter e on p.patient_id=e.patient_id																	"
            + "                				inner join obs o on o.encounter_id=e.encounter_id																		"
            + "                			where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                				and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "					) inicio_inh 																														"
            + "					inner join encounter e on e.patient_id=inicio_inh.patient_id 																		"
            + "					inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																	"
            + "					inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id and obsDTINH.voided=0 												"
            + "					where e.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (6,9) and obsLevTPI.concept_id=6122 and obsLevTPI.value_coded in (1257,1065,1256) "
            + "						and obsDTINH.concept_id=1719 and obsDTINH.value_coded=23955 																	"
            + "						and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 5 MONTH) and e.location_id=:location "
            + "						group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=2 													"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select inicio_inh.patient_id from 																								"
            + "						(																																"
            + "							select p.patient_id, o.value_datetime data_inicio_inh 																		"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 				"
            + "									and o.value_datetime < :endDate and e.location_id=:location 														"
            + "							union 																														"
            + "							select p.patient_id, e.encounter_datetime data_inicio_inh 																	"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "									and e.encounter_datetime < :endDate and e.location_id=:location  													"
            + "							union 																														"
            + "             					select p.patient_id, e.encounter_datetime data_inicio_inh from patient p											"
            + "             						inner join encounter e on p.patient_id=e.patient_id																"
            + "                					inner join obs o on o.encounter_id=e.encounter_id																	"
            + "                				where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                					and e.encounter_datetime < :endDate and e.location_id=:location  													"
            + "						) inicio_inh 																													"
            + "						inner join encounter e on e.patient_id=inicio_inh.patient_id 																	"
            + "						inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																"
            + "						left join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id and obsDTINH.voided=0 											"
            + "								and obsDTINH.concept_id=1719 and obsDTINH.value_coded=23955 															"
            + "								and obsDTINH.obs_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) 		"
            + "						where e.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (6,9) and obsLevTPI.concept_id=6122 and obsLevTPI.value_coded in (1257,1065,1256) "
            + "							and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH)  			"
            + "							and obsDTINH.concept_id is null and e.location_id=:location 																"
            + "							group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=3 												"
            + "					) inicio_inh 																														"
            + "					inner join 																															"
            + "					( 																																	"
            + "						select inicio_inh.patient_id from 																								"
            + "						( 																																"
            + "							select p.patient_id, o.value_datetime data_inicio_inh 																		"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 				"
            + "									and o.value_datetime < :endDate and e.location_id=:location 														"
            + "							union 																														"
            + "							select p.patient_id, e.encounter_datetime data_inicio_inh 																	"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "									and e.encounter_datetime < :endDate and e.location_id=:location 													"
            + "							union 																														"
            + "							select p.patient_id, e.encounter_datetime data_inicio_inh from patient p													"
            + "             						inner join encounter e on p.patient_id=e.patient_id																"
            + "                					inner join obs o on o.encounter_id=e.encounter_id																	"
            + "                				where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                					and e.encounter_datetime < :endDate and e.location_id=:location 													"
            + "						) inicio_inh 																													"
            + "						inner join encounter e on e.patient_id=inicio_inh.patient_id 																	"
            + "						inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																"
            + "						inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id and obsDTINH.voided=0 											"
            + "						where e.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (6,9) and obsLevTPI.concept_id=6122 and obsLevTPI.value_coded in (1257,1065,1256) "
            + "							and obsDTINH.concept_id=1719 and obsDTINH.value_coded=23955 																"
            + "							and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) and e.location_id=:location "
            + "							group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=1 												"
            + "					) inicio_inh_dt on inicio_inh_dt.patient_id = inicio_inh.patient_id 																"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select p.patient_id, o.value_datetime data_inicio_inh 																			"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 					"
            + "								and o.value_datetime < :endDate and e.location_id=:location 															"
            + "						union 																															"
            + "						select p.patient_id, e.encounter_datetime data_inicio_inh 																		"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "								and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "					 	union 																															"
            + "					 	select p.patient_id, e.encounter_datetime data_inicio_inh from patient p														"
            + "             					inner join encounter e on p.patient_id=e.patient_id																	"
            + "                				inner join obs o on o.encounter_id=e.encounter_id																		"
            + "                			where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                				and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "					) inicio_inh 																														"
            + "					inner join encounter e on e.patient_id=inicio_inh.patient_id 																		"
            + "					inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id 																	"
            + "					inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																	"
            + "					where e.voided=0 and obsDTINH.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (60) 											"
            + "						and obsDTINH.concept_id=23986 and obsDTINH.value_coded=1098  and obsLevTPI.concept_id=23985 and obsLevTPI.value_coded in (656,23982) "
            + "						and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) and e.location_id=:location "
            + "						group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=6 													"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select p.patient_id, o.value_datetime data_inicio_inh 																			"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 					"
            + "								and o.value_datetime < :endDate and e.location_id=:location 															"
            + "						union 																															"
            + "						select p.patient_id, e.encounter_datetime data_inicio_inh 																		"
            + "							from	patient p 																											"
            + "								inner join encounter e on p.patient_id=e.patient_id 																	"
            + "								inner join obs o on o.encounter_id=e.encounter_id 																		"
            + "							where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "								and e.encounter_datetime < :endDate and e.location_id=:location 														"
            + "						union 																															"
            + "             				select p.patient_id, e.encounter_datetime data_inicio_inh from patient p												"
            + "             					inner join encounter e on p.patient_id=e.patient_id																	"
            + "                				inner join obs o on o.encounter_id=e.encounter_id																		"
            + "                			where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                				and e.encounter_datetime < :endDate and e.location_id=:location   														"
            + "					) inicio_inh 																														"
            + "					inner join encounter e on e.patient_id=inicio_inh.patient_id 																		"
            + "					inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id 																	"
            + "					inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																	"
            + "					where e.voided=0 and obsDTINH.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (60) 											"
            + "						and obsDTINH.concept_id=23986 and obsDTINH.value_coded=23720  and obsLevTPI.concept_id=23985 and obsLevTPI.value_coded in (656,23982) "
            + "						and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 5 MONTH) and e.location_id=:location "
            + "						group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=2 													"
            + "					union 																																"
            + "					select inicio_inh.patient_id from 																									"
            + "					( 																																	"
            + "						select inicio_inh.patient_id from 																								"
            + "						( 																																"
            + "							select p.patient_id, o.value_datetime data_inicio_inh 																		"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 				"
            + "									and o.value_datetime < :endDate and e.location_id=:location 														"
            + "							union 																														"
            + "							select p.patient_id, e.encounter_datetime data_inicio_inh 																	"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "									and e.encounter_datetime < :endDate and e.location_id=:location 													"
            + "							union 																														"
            + "             					select p.patient_id, e.encounter_datetime data_inicio_inh from patient p											"
            + "             						inner join encounter e on p.patient_id=e.patient_id																"
            + "                					inner join obs o on o.encounter_id=e.encounter_id																	"
            + "                				where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                					and e.encounter_datetime < :endDate and e.location_id=:location  													"
            + "						) inicio_inh 																													"
            + "						inner join encounter e on e.patient_id=inicio_inh.patient_id 																	"
            + "						inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id 																"
            + "						inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																"
            + "						where e.voided=0 and obsDTINH.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (60) 										"
            + "							and obsDTINH.concept_id=23986 and obsDTINH.value_coded=1098  and obsLevTPI.concept_id=23985 and obsLevTPI.value_coded in (656,23982) "
            + "							and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) and e.location_id=:location "
            + "							group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=3												"
            + "					) inicio_inh 																														"
            + "					inner join 																															"
            + "					( 																																	"
            + "						select inicio_inh.patient_id from 																								"
            + "						( 																																"
            + "							select p.patient_id, o.value_datetime data_inicio_inh 																		"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id																	"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where  p.voided=0 and  e.voided=0 and o.voided=0 and e.encounter_type in (6,9,53) and o.concept_id=6128 				"
            + "									and o.value_datetime < :endDate and e.location_id=:location 														"
            + "							union 																														"
            + "							select p.patient_id, e.encounter_datetime data_inicio_inh 																	"
            + "								from	patient p 																										"
            + "									inner join encounter e on p.patient_id=e.patient_id 																"
            + "									inner join obs o on o.encounter_id=e.encounter_id 																	"
            + "								where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9)  and o.concept_id=6122 and o.value_coded=1256  "
            + "									and e.encounter_datetime < :endDate and e.location_id=:location 													"
            + "							union 																														"
            + "             					select p.patient_id, e.encounter_datetime data_inicio_inh from patient p											"
            + "             						inner join encounter e on p.patient_id=e.patient_id																"
            + "                					inner join obs o on o.encounter_id=e.encounter_id																	"
            + "                				where e.voided=0 and p.voided=0 and o.voided=0 and o.concept_id=23985 and o.value_coded in (656,23982) and e.encounter_type=60 "
            + "                					and e.encounter_datetime < :endDate and e.location_id=:location  													"
            + "						) inicio_inh 																													"
            + "						inner join encounter e on e.patient_id=inicio_inh.patient_id																	"
            + "						inner join obs obsDTINH on e.encounter_id=obsDTINH.encounter_id 																"
            + "						inner join obs obsLevTPI on e.encounter_id=obsLevTPI.encounter_id 																"
            + "						where e.voided=0 and obsDTINH.voided=0 and obsLevTPI.voided=0 and e.encounter_type in (60) 										"
            + "							and obsDTINH.concept_id=23986 and obsDTINH.value_coded=23720  and obsLevTPI.concept_id=23985 and obsLevTPI.value_coded in (656,23982) "
            + "							and e.encounter_datetime between inicio_inh.data_inicio_inh and (inicio_inh.data_inicio_inh + INTERVAL 7 MONTH) and e.location_id=:location "
            + "							group by inicio_inh.patient_id,inicio_inh.data_inicio_inh having count(*)>=1   												"
            + "				 ) inicio_inh_dt on inicio_inh_dt.patient_id = inicio_inh.patient_id 																	";

    public static final String findPatientsWhoStarted3HPTherapyBeforeReportingEndDate =
        "															"
            + "select patient_id from																												"
            + "(																																	"
            + "	select p.patient_id, e.encounter_datetime data_inicio_3HP																			"
            + "		from	patient p																												"
            + "			inner join encounter e on p.patient_id=e.patient_id																			"
            + "			inner join obs o on o.encounter_id=e.encounter_id																			"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9) and o.concept_id=1719 and o.value_coded=23954 		"
            + "			and e.encounter_datetime < :endDate and e.location_id= :location															"
            + "	union																																"
            + "	select p.patient_id, e.encounter_datetime data_inicio_3HP																			"
            + "		from	patient p																												"
            + "			inner join encounter e on p.patient_id=e.patient_id																			"
            + "			inner join obs o on o.encounter_id=e.encounter_id																			"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type=60  and o.concept_id=23985 and o.value_coded in (23954,23984) "
            + "			and	e.encounter_datetime < :endDate and e.location_id= :location															"
            + ") inicio_3HP																															";

    public static final String findPatientsWhoCompleted3HPTherapy =
        "																								"
            + "select inicio_3HP.patient_id 																																"
            + "from (                                                                                                                                                    "
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9) and o.concept_id=1719 and o.value_coded=23954                     		"
            + "			and e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "		union                                                                                                                                            	"
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type=60  and o.concept_id=23985 and o.value_coded in (23954,23984)              		"
            + "			and e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "	) inicio_3HP                                                                                                                                        	"
            + "	inner join encounter e on e.patient_id=inicio_3HP.patient_id                                                                                        	"
            + "	inner join obs o on o.encounter_id=e.encounter_id                                                                                                    	"
            + "	where e.voided=0 and o.voided=0 and e.encounter_type in (6,9) and o.concept_id=1719 and o.value_coded=23954                                          	"
            + "		and e.encounter_datetime between inicio_3HP.data_inicio_3HP and (inicio_3HP.data_inicio_3HP + INTERVAL 4 month) and e.location_id= :location     	"
            + "		group by inicio_3HP.patient_id,inicio_3HP.data_inicio_3HP having count(*)>=3                                                                        "
            + "	union                                                                                                                                                	"
            + "	select inicio_3HP.patient_id from                                                                                                                    	"
            + "	(                                                                                                                                                    	"
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9) and o.concept_id=1719 and o.value_coded=23954                     		"
            + "			and e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "		union                                                                                                                                            	"
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type=60  and o.concept_id=23985 and o.value_coded in (23954,23984)              		"
            + "			and  e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "	) inicio_3HP                                                                                                                                        	"
            + "		inner join encounter e on e.patient_id= inicio_3HP.patient_id                                                                                       "
            + "		inner join obs obs3hp on obs3hp.encounter_id=e.encounter_id                                                                                         "
            + "		inner join obs obsTipo on obsTipo.encounter_id=e.encounter_id                                                                                       "
            + "	where e.voided=0 and obs3hp.voided=0 and obsTipo.voided=0                                                                                             	"
            + "		and e.encounter_type=60 and obs3hp.concept_id=23985 and obs3hp.value_coded in (23954,23984) and obsTipo.concept_id=23986 and obsTipo.value_coded=23720  "
            + "		and e.encounter_datetime between inicio_3HP.data_inicio_3HP and (inicio_3HP.data_inicio_3HP + INTERVAL 4 month) and e.location_id= :location     	"
            + "		group by inicio_3HP.patient_id,inicio_3HP.data_inicio_3HP having count(*)>=1                                                                        "
            + "	union                                                                                                                                                	"
            + "	select inicio_3HP.patient_id from                                                                                                                    	"
            + "	(                                                                                                                                                    	"
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type in (6,9) and o.concept_id=1719 and o.value_coded=23954                     		"
            + "			and e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "		union                                                                                                                                            	"
            + "		select p.patient_id, e.encounter_datetime data_inicio_3HP from patient p                                                                            "
            + "			inner join encounter e on p.patient_id=e.patient_id                                                                                        		"
            + "			inner join obs o on o.encounter_id=e.encounter_id                                                                                        		"
            + "		where p.voided=0 and e.voided=0 and o.voided=0 and e.encounter_type=60  and o.concept_id=23985 and o.value_coded in (23954,23984)              		"
            + "			and  e.encounter_datetime < :endDate and e.location_id= :location                                                                        		"
            + "	) inicio_3HP                                                                                                                                        	"
            + "		inner join encounter e on e.patient_id= inicio_3HP.patient_id                                                                                       "
            + "		inner join obs obs3hp on obs3hp.encounter_id=e.encounter_id                                                                                         "
            + "		inner join obs obsTipo on obsTipo.encounter_id=e.encounter_id                                                                                       "
            + "	where e.voided=0 and obs3hp.voided=0 and obsTipo.voided=0                                                                                             	"
            + "		and e.encounter_type=60 and obs3hp.concept_id=23985 and obs3hp.value_coded in (23954,23984) and obsTipo.concept_id=23986 and obsTipo.value_coded=1098 "
            + "		and e.encounter_datetime between inicio_3HP.data_inicio_3HP and (inicio_3HP.data_inicio_3HP + INTERVAL 4 month) and e.location_id= :location    	"
            + "		group by inicio_3HP.patient_id,inicio_3HP.data_inicio_3HP having count(*)>=3                                                                        ";
  }
}
